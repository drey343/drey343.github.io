(()=>{var t={190:t=>{function s(t,s,o){var n=function(){var e=2091639*t+2.3283064365386963e-10*o;return t=s,s=e-(o=0|e)};return n.getState=function(){return[t,s,o]},n.nextFloat=e,n.nextInt=i,n}function e(t,s){var e,i,o=this();if("number"==typeof s)e=t,i=s;else{if("number"!=typeof t)return o;e=0,i=t}return e+o*(i-e)}function i(t,s){return Math.floor(this.nextFloat(t,s))}function o(t){var e,i,o,n,a=4022871197;t="X"+(t||+new Date);for(var r=0;r<2;r++){for(var c=0;c<t.length;c++)o=.02519603282416938*(a+=t.charCodeAt(c)),o-=a=o>>>0,a=(o*=a)>>>0,a+=4294967296*(o-=a);n=2.3283064365386963e-10*(a>>>0),0===r?e=n:i=n}return s(e,i,1)}o.fromState=function(t){return s.apply(null,t)},t.exports=o}},s={};function e(i){var o=s[i];if(void 0!==o)return o.exports;var n=s[i]={exports:{}};return t[i](n,n.exports,e),n.exports}(()=>{"use strict";e(190);const t=(t,s)=>{for(var e=!1,i=s[0].x,o=s[0].x,n=s[0].y,a=s[0].y,r=1;r<s.length;r++){var c=s[r];i=Math.min(c.x,i),o=Math.max(c.x,o),n=Math.min(c.y,n),a=Math.max(c.y,a)}if(t.x<i||t.x>o||t.y<n||t.y>a)return!1;for(var h=0,l=s.length-1;h<s.length;l=h++)s[h].y>t.y!=s[l].y>t.y&&t.x<(s[l].x-s[h].x)*(t.y-s[h].y)/(s[l].y-s[h].y)+s[h].x&&(e=!e);return e},s=(t,s,e)=>Math.max(Math.min(t,e),s),i=(t,e,{dh:i=0,ds:o=0,db:n=0,da:a=0,h:r=null,s:c=null,b:h=null,a:l=null}={})=>t.color(null!==r?r:((t,s,e)=>{const i=t+s;return i<0?e+i:i%(e+1)})(t.hue(e),i,360),null!==c?c:s(t.saturation(e)+o,0,100),null!==h?h:s(t.brightness(e)+n,0,100),null!==l?l:s(t.alpha(e)+a,0,1)),o=({p5:t,settings:s,backgroundColor:e})=>{t.push(),t.noFill(),t.strokeWeight(s.s(.1)),t.stroke(e),t.stroke("#111"),t.rectMode(t.CORNER),t.rect(0,0,s.s(1),s.sy(1)),t.pop()};class n extends class{constructor({p5:t,x:s,y:e,color:i,width:o,height:n,velocity:a,acceleration:r,angle:c=0,angleStrategy:h="heading",aVelocity:l=0,aAcceleration:p=0,shape:d="ellipse",meta:g={},particleInit:u,mass:y=1,stroke:m,strokeWeight:f}){this.p5=t,this.x=s,this.y=e,this.position=t.createVector(s,e),this.velocity=a||t.createVector(0,0),this.acceleration=r||t.createVector(0,0),this.color=i,this.stroke=m,this.strokeWeight=f,this.width=o,this.height=n,this.angleStrategy=h,this.angle=c,this.aVelocity=l,this.aAcceleration=p,this.shape=d,this.meta=g,this.mass=y,u&&u(this)}move({velocityLimit:t}={}){this.velocity=this.velocity.add(this.acceleration),void 0!==t&&this.velocity.limit(t),this.position=this.position.add(this.velocity),this.aVelocity+=this.aAcceleration,this.angle+=this.aVelocity}scaleAcc(t){this.acceleration.mult(t)}draw({layer:t,position:s=null}={}){s=s||this.position,t=t||this.p5;const e=(()=>"heading"===this.angleStrategy?Math.atan2(this.velocity.x,this.velocity.y):this.angle)();switch(t.push(),t.rectMode("center"),t.translate(s.x,s.y),t.rotate(e),this.stroke&&this.strokeWeight?(t.stroke(this.stroke),t.strokeWeight(this.strokeWeight)):t.noStroke(),t.fill(this.color),this.shape){case"ellipse":t.ellipse(0,0,this.width,this.height||0);break;case"rect":t.rect(0,0,this.height,this.width);break;case"triangle":t.triangle(-this.width/2,this.height/2,0,-this.height/2,0,this.width/2,this.height/2)}t.pop()}adjustVelocity(t){return"function"==typeof t?t(this.velocity):this.velocity=t,this}adjustAcceleration(t){return"function"==typeof t?t(this.acceleration,this):this.acceleration=t,this}applyForce(t){this.acceleration.add(t)}applyRepeller(t){const s=t.repel(this);this.applyForce(s)}applyAttractor(t){const s=t.attract(this);this.applyForce(s)}adjustColor(t){return"function"==typeof t?t(this.color,this):this.color=t,this}adjustWidth(t){this.width=t}scaleAcceleration(t){this.acceleration.mult(t)}affect(t,s){const{G:e,polarity:i,range:o,pow:n,limit:a}={G:500,range:{min:2,max:50},...s},r=this.position.copy().sub(t.position),c=this.p5.constrain(r.magSq(),25,2500),h=i*(e*(this.mass*t.mass)/c);r.setMag(h),a&&r.limit(a),t.applyForce(r)}repel(t,s){return this.affect(t,{polarity:-1,...s})}attract(t,s){return this.affect(t,{polarity:1,...s})}}{constructor({scannerCount:t,scannerSort:s,scan:e,scanAngle:i,scanDistance:o,onScannerSelection:n,...a}){super(a),this.scan=e,this.scanAngle=i,this.scanDistance=o,this.scannerCount=t,this.scannerSort=s,this.onScannerSelection=n,this.history=[]}scanCone({scanAngle:t,scanDistance:s}={}){t=t??this.scanAngle,s=s??this.scanDistance;const e=[];for(let i=0;i<this.scannerCount;i++){const o=this.p5.createVector(0,-s);o.setHeading(this.velocity.heading()),o.rotate(this.p5.map(i,0,this.scannerCount,.5*-t,.5*t)),o.add(this.position),e.push(o)}return e}visionCone(t){return[this.position,...this.scanCone(t)]}scout(t){this.startT||(this.startT=t);const s=t-this.startT,e=this.scanCone(0===s?2*Math.PI:this.scanAngle).map(((t,s)=>this.scan(t,s)));e.sort(this.scannerSort);const i=e[0];return this.onScannerSelection&&this.onScannerSelection(this,i),this.selected=i,this.selected}move(t,{pushHistory:s=!0}={}){this.scout(t),this.velocity=this.selected.p.sub(this.position),s&&this.history.push(this.position.copy()),super.move(t)}}class a{constructor({p5:t,settings:s,x:e=0,y:i=0,height:o,width:n,detail:a,scalar:r,steps:c=500}){this.p5=t,this.settings=s,this.start=t.random(2e5),this.p5.noiseSeed(this.start),this.x=e,this.y=i,this.width=n||s.s(1),this.height=o||s.sy(1),this.scalar=r,a&&this.p5.noiseDetail(a);const h=(({p5:t,x:s,y:e,width:i,height:o,noiseScalar:n=1,steps:a=100,start:r=0,cb:c})=>{let h=1,l=0;for(let c=0;c<o;c+=o/a)for(let o=0;o<i;o+=i/a){const i=t.noise((s+o+r)*n,(e+c+r)*n);i<h&&(h=i),i>l&&(l=i)}return{min:h,max:l}})({p5:this.p5,x:0,y:0,height:this.height,width:this.width,steps:c,noiseScalar:this.scalar,start:this.start});this.min=h.min,this.max=h.max,this.range=this.max-this.min,this.strata=[],this.addStrata({name:"all",startP:0,sizeP:1})}mapRange(t){return this.p5.map(t,0,1,0,this.range)}mapNoise(t){return this.p5.map(t,0,1,this.min,this.max)}unmapNoise(t){return this.p5.map(t,this.min,this.max,0,1)}addStrata({name:t,startP:s,sizeP:e}){const i={name:t,start:this.mapNoise(s),end:this.mapNoise(s+e)};return this.strata.forEach(((t,s,e)=>{t.end<i.start||t.start>i.end?console.log("no effect"):t.start<i.start&&t.end>i.end?(console.log("splitting strata"),e.splice(s,1),e.push({name:t.name,start:t.start,end:i.start}),e.push({name:t.name,start:i.end,end:t.end})):t.start<i.start&&t.end<i.end?(console.log("truncating end"),t.end=i.start):t.start>i.start&&t.end>i.end&&(console.log("truncating end"),t.start=i.end)})),this.strata.push(i),this}getStrata({n:t,gapP:s=0}){const e=this.mapRange(s);return this.strata.find((s=>t>s.start+e/2&&t<s.end-e/2))}noise(t,s,e={}){"object"==typeof s&&(e=s,s=null);const{scalar:i,start:o}=e||{},n=i||this.scalar,a=o||this.start,r=this.p5.noise((t+a)*n,s?(s+a)*n:void 0);return e.strata?{noise:r,strata:this.getStrata({n:r,gapP:e?.gapP})}:r}}let r,c;document.getElementsByClassName("loading")[0].style.display="none";const h=({p5:t,settings:s,baseColor:e,backgroundColor:i})=>{t.noLoop(),window.done=!0,fxpreview(),window.addEventListener("keypress",(s=>{"s"===s.key&&t.save("36inchChain.png")})),o({p5:t,settings:s,backgroundColor:i})};document.addEventListener("DOMContentLoaded",(()=>{const e=~~(123456789*fxrand()),l=document.getElementById("container");new p5((e=>l=>{const p=new URLSearchParams(window.location.search);p.get("seed")&&(e=p.get("seed")),l.colorMode(l.HSB),console.log({seed:e}),l.randomSeed(e),l.noiseSeed(e);let d,g,u,y=0,m=l.random(60,100);l.colorMode(l.HSB);let f,v=l.color(l.random(360),60,100);l.random()<.5?(v=l.color("#222"),f=l.color(l.random(360),m,90)):(v=l.color(l.random(360),60,100),f="black"),l.setup=()=>{l.noStroke(),l.ellipseMode(l.CENTER),l.rectMode(l.CENTER),c=(({canvasWidth:t,canvasHeight:s,p5:e,publishAttributes:i=!1})=>{const o={s:s=>parseFloat((t*s).toFixed(5)),sy:t=>parseFloat((s*t).toFixed(5)),p:s=>parseFloat((s/t).toFixed(5)),py:t=>parseFloat((t/s).toFixed(5)),canvas:{width:t,height:s},field:[{x:0,y:0},{x:t,y:0},{x:t,y:s},{x:0,y:s}]};return i&&(window.$fxhashFeatures={}),o})({p5:l,canvasWidth:1e3,canvasHeight:1e3,area:[{x:0,y:0}],publishAttributes:!0}),console.log(window.$fxhashFeatures);const t=(()=>{const t=i(l,v,{b:l.brightness(v)/2});l.push(),l.colorMode(l.RGB);const s=l.red(t),e=l.green(t),o=l.blue(t);return l.pop(),{r:s,g:e,b:o}})(),e=`rgba(${t.r},${t.g},${t.b},1)`;r=l.createCanvas(c.canvas.width,c.canvas.height),r.parent("fullscreen"),document.getElementById("fullscreen").style.backgroundColor=e,d=()=>{l.background(v)},window.addEventListener("keypress",(t=>{" "===t.key&&(l.isLooping()?l.noLoop():l.loop())})),Array.from(Array(10)).map((()=>l.color(l.random(360),100,100,1)));const o=c.s(l.random(.3,.7)),h=c.sy(l.random(.3,.7)),p=s(Math.floor(l.randomGaussian(40,20)),20,100);g=new a({p5:l,settings:c,steps:500,scalar:s(l.randomGaussian(1.5,.4),.3,3)}),u=(({p5:t,settings:s,scoutCount:e,noiseField:o,scoutX:a,scoutY:r,color:c})=>{const h=t.random()<.05,l=t.random(["random","ordered"]);return Array.from(Array(e)).map(((p,d)=>{let g,u;"random"===l?(g=a+s.s(.2*t.random(-1,1)),u=r+s.sy(.2*t.random(-1,1))):(a=s.s(t.random(.3,.6)),r=s.sy(t.random(.3,.6)),g=a+s.s(.01)*d,u=r+s.sy(.01)*d);const y=new n({p5:t,settings:s,x:g,y:u,width:s.s(t.random(.025,.06)),height:s.s(t.random(.045,.06)),velocity:t.createVector(0,-s.s(.005)),color:i(t,c,{b:t.map(d,0,e,20,100),dh:t.random(-5,5)}),strokeWeight:s.s(.004),stroke:t.color(0,0,0,1),scannerCount:30,scanAngle:.9*Math.PI,scanDistance:s.s(.01),scan:({x:e,y:i},n)=>{o.noise(s.p(g),s.py(u));const a=o.noise(s.p(e),s.py(i));return{p:t.createVector(e,i),n:a}},scannerSort:(t,e)=>{const i=o.noise(s.p(g),s.py(u));return Math.abs(i-t.n)-Math.abs(i-e.n)}});return h&&(y.color=t.color(t.random(360),80,80),y.rainbow=!0,y.rainbowRotation=t.random(1,5)),y.ogColor=i(t,y.color),y.active=!0,y.layer=t.createGraphics(s.s(1),s.sy(1)),y}))})({p5:l,settings:c,scoutCount:p,noiseField:g,scoutX:o,scoutY:h,color:l.random([i(l,l.color("gold"),{b:100,s:75}),i(l,l.color("silver"),{b:90})])})};const x=({p:t,settings:s})=>t.active&&t.position.x>s.s(0)&&t.position.y>s.sy(0)&&t.position.x<s.s(1)&&t.position.y<s.sy(1);l.draw=()=>{if(y++,y%100==0&&console.log(y),0!==u.filter((t=>t.active)).length)if(1===y?u.forEach((t=>t.scanAngle=2*Math.PI)):u.forEach((t=>t.scanAngle=.6*Math.PI)),y>1e3&&!u.some((t=>x({p:t,settings:c})))||y>2e3)h({p5:l,settings:c,backgroundColor:v});else for(let s=0;s<1;s++)d({p5:l,settings:c,backgroundColor:v}),o({p5:l,settings:c,backgroundColor:v}),u=u.filter(((t,s)=>{if(x({p:t,settings:c})&&t.history.length>50&&t.history.reduce(((s,e)=>Math.max(s,t.history.filter((s=>s.dist(e)<t.scanDistance/10)).length)),0)>1)return console.log(`scout ${s} banished for repeating`),!1;const e=t.history.filter((s=>s.dist(t.position)<1.5*t.width)).length;return y>20&&e/t.history.length>.5?(console.log(`scout ${s} banished for over-colliding by ratio`),!1):history.length>5&&e>30?(console.log(`scout ${s} banished for over-colliding by volume`),!1):!(t.isClosing&&t.history.filter((s=>s.dist(t.position)<1.75*t.width)).length>25&&(console.log(`scout ${s} banished for over-colliding at closure`),1))})),u.forEach(((s,e,o)=>{if(y>0){if(x({p:s,settings:c})){let i=s.history.slice(0,20).filter((e=>e.dist(s.position)<c.s(.2)&&t(e,s.visionCone({scanDistance:2*s.width,scanAngle:2*s.scanAngle}))));i.sort(((t,e)=>t.dist(s.position)-e.dist(s.position)));const o=i?.[0],n=o&&i?.[0]===s.history?.[0],a=n?l.createGraphics(c.s(1),c.sy(1)):s.layer;a.push();const r=s.history.slice(0,1).filter((t=>t.dist(s.position)<c.s(.2))).filter((e=>t(e,s.visionCone({scanDistance:5.5*s.scanDistance,scanAngle:s.scanAngle}))));r.sort(((t,e)=>s.position.dist(t)-s.position.dist(e)));const h=r?.[0];if(h&&h===s.history[0]){s.isClosing=!0;const t=h.dist(s.position);if(t>4*s.scanDistance&&t<5.5*s.scanDistance)t>5.25*s.scanDistance?s.scanDistance*=1.13:t>5*s.scanDistance?s.scanDistance*=1.05:t>4.75*s.scanDistance||(t>4.5*s.scanDistance?s.scanDistance*=.9:t>4.25*s.scanDistance?s.scanDistance*=1.1:s.scanDistance);else if(t>2*s.scanDistance);else if(t<1.5*s.scanDistance){s.active=!1;const t=s.history[0].copy().sub(s.position).angleBetween(s.history[0].copy().sub(s.history[1]));Math.abs(t)<Math.PI/2&&(console.log(`scout ${e} banished for bad closure angle`),u.splice(e,1))}}a.fill(s.color),a.strokeWeight(s.strokeWeight),a.stroke(s.stroke),a.ellipse(s.position.x,s.position.y,s.width),n&&(a.erase(),a.strokeWeight(s.strokeWeight/2),a.stroke(l.color(0,0,0,1)),a.fill(l.color(0,0,0,1)),i.forEach((t=>{a.ellipse(t.x,t.y,1.03*s.width)})),a.noErase(),s.layer.image(a,0,0,c.s(1),c.sy(1)),a.remove()),a.pop()}l.image(s.layer,0,0,c.s(1),c.sy(1)),s.active&&(s.rainbow&&(s.color=i(l,s.color,{dh:s.rainbowRotation})),s.move(y,{pushHistory:x({p:s,settings:c})}))}})),o({p5:l,settings:c,backgroundColor:v});else h({p5:l,settings:c,backgroundColor:v})}})(e),l)}))})()})();